<div class="logo"><img src="/image/logo.png"></div>
<form id="logout-form">
    <button class="logout" type="submit">LOG OUT</button>
</form>
<div class="position1 box1"></div>
<div class="position2 box2">
    <div class="profile_background"></div>
    <div class="profile"><img src="/image/í”„ë¡œí•„ì˜ˆì‹œ.png" height="200px" width="160px"></div>
    <div class="introduction">ì‚°ã…ŒÅ€í• ã…‡rë²„ã‚ºl ì € ì•ˆ ìš¸ì—ˆëŠ”ë° ì„ ë¬¼ ì£¼ã‚“Ä±ã„´rìš©</div>
    <div class="music">â™ª We Wish You A Merry Christmas</div>
    <div class="position5"><hr></div>
    <div class="d_day">
        ChristmasğŸ…
        <div id="newcountdown"></div>
    </div>
    <div class="cal">
        <table id="calendar">
            <tr>
                <td class="font8"><label onclick="beforem()" id="before"></label></td>
                <td colspan="5" id="yearmonth"></td>
                <td class="font8"><label onclick="nextm()" id="next"></label></td>
            </tr>
            <tr>
                <td class="fontsun">ì¼</td>
                <td class="fontday">ì›”</td>
                <td class="fontday">í™”</td>
                <td class="fontday">ìˆ˜</td>
                <td class="fontday">ëª©</td>
                <td class="fontday">ê¸ˆ</td>
                <td class="fontsat">í† </td>
            </tr>
        </table>
    </div>
    <div class="music_button">
        <input id="input3" type="button" onclick="audio.play();" value="BGM ì¬ìƒ"> &nbsp;
        <input id="input3" type="button" onclick="audio.pause();" value="ì¼ì‹œì •ì§€">
    </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const logoutBtn = document.querySelector('.logout');

    if (logoutBtn) {
      logoutBtn.addEventListener('click', async (e) => {
        e.preventDefault();

        try {
          // 1. í´ë¼ì´ì–¸íŠ¸ í† í° ë¡œê·¸ì•„ì›ƒ
          if (window.Kakao && Kakao.Auth) {
            await Kakao.Auth.logout(); // async/await ë°©ì‹ë„ ê°€ëŠ¥
            console.log('Kakao ë¡œê·¸ì•„ì›ƒ ì™„ë£Œ');
          }

          // 2. ì„œë²„ ë¡œê·¸ì•„ì›ƒ
          const response = await fetch('/auth/logout', {
            method: 'POST',
            credentials: 'include'
          });

          if (response.redirected) {
            location.href = response.url;
          } else {
            alert('ë¡œê·¸ì•„ì›ƒ ì‹¤íŒ¨');
          }
        } catch (err) {
          console.error('ë¡œê·¸ì•„ì›ƒ ì¤‘ ì˜¤ë¥˜:', err);
          alert('ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬ ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
      });
    }
  });
</script>