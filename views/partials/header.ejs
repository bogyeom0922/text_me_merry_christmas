<div class="logo"><img src="/image/logo.png"></div>
<form id="logout-form">
    <button class="logout" type="submit">LOG OUT</button>
</form>
<div class="position1 box1"></div>
<div class="position2 box2">
    <div class="profile_background"></div>
    <div class="profile"><img src="/image/프로필예시.png" height="200px" width="160px"></div>
    <div class="introduction">산ㅌŀ할ㅇr버ズl 저 안 울었는데 선물 주んıㄴr용</div>
    <div class="music">♪ We Wish You A Merry Christmas</div>
    <div class="position5"><hr></div>
    <div class="d_day">
        Christmas🎅
        <div id="newcountdown"></div>
    </div>
    <div class="cal">
        <table id="calendar">
            <tr>
                <td class="font8"><label onclick="beforem()" id="before"></label></td>
                <td colspan="5" id="yearmonth"></td>
                <td class="font8"><label onclick="nextm()" id="next"></label></td>
            </tr>
            <tr>
                <td class="fontsun">일</td>
                <td class="fontday">월</td>
                <td class="fontday">화</td>
                <td class="fontday">수</td>
                <td class="fontday">목</td>
                <td class="fontday">금</td>
                <td class="fontsat">토</td>
            </tr>
        </table>
    </div>
    <div class="music_button">
        <input id="input3" type="button" onclick="audio.play();" value="BGM 재생"> &nbsp;
        <input id="input3" type="button" onclick="audio.pause();" value="일시정지">
    </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const logoutBtn = document.querySelector('.logout');

    if (logoutBtn) {
      logoutBtn.addEventListener('click', async (e) => {
        e.preventDefault();

        try {
          // 1. 클라이언트 토큰 로그아웃
          if (window.Kakao && Kakao.Auth) {
            await Kakao.Auth.logout(); // async/await 방식도 가능
            console.log('Kakao 로그아웃 완료');
          }

          // 2. 서버 로그아웃
          const response = await fetch('/auth/logout', {
            method: 'POST',
            credentials: 'include'
          });

          if (response.redirected) {
            location.href = response.url;
          } else {
            alert('로그아웃 실패');
          }
        } catch (err) {
          console.error('로그아웃 중 오류:', err);
          alert('로그아웃 처리 중 문제가 발생했습니다.');
        }
      });
    }
  });
</script>